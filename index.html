<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Physics Practice Hub</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #eef2f3;
      margin-right: 250px; /* Reserve space for difficulty panel */
    }
    h1, h2, h3 { color: #333; }
    .section { margin-top: 30px; border-top: 1px solid #ccc; padding-top: 20px; }
    .topics-grid { display: flex; flex-wrap: wrap; gap: 20px; }
    .topic-column { flex: 1 1 300px; }
    label { display: block; margin: 5px 0; }
    button { margin-top: 20px; padding: 10px 15px; font-size: 1em; }
    #question-box {
      background: #fff;
      padding: 15px;
      border-radius: 10px;
      margin-top: 30px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    #score-box { font-weight: bold; margin-top: 10px; }
    .question-img { max-width: 100%; height: auto; margin: 10px 0; }
    /* Difficulty panel */
    #difficulty-container {
      position: fixed;
      top: 100px;
      right: 20px;
      width: 200px;
      background: #fff;
      border: 1px solid #ccc;
      padding: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    #difficulty-container h3 { margin-top: 0; }
  </style>
</head>
<body>
  <h1>Cambridge Physics 9702 Practice Hub</h1>

  <!-- Whole Course Section -->
  <div class="section">
    <h2>Whole Course</h2>
    <label>
      <input type="checkbox" id="whole-defs" onchange="toggleByGroup('defs', this.checked)">
      Definitions
    </label>
    <label>
      <input type="checkbox" id="whole-eqs" onchange="toggleByGroup('eqs', this.checked)">
      Equations
    </label>
    <button onclick="startPractice()">Start Practice</button>
  </div>

  <!-- By Topic Section -->
  <div class="section">
    <h2>By Topic</h2>
    <div class="topics-grid">
      <div class="topic-column" id="topic-columns-left"></div>
      <div class="topic-column" id="topic-columns-right"></div>
    </div>
  </div>

  <!-- Another Start Practice Button -->
  <div class="section">
    <button onclick="startPractice()">Start Practice</button>
  </div>

  <div id="score-box">Score: <span id="score">0</span></div>
  <div id="question-box"></div>
  
  <!-- Container for dynamic diagrams (currently not used) -->
  <div id="diagramContainer"></div>
  
  <!-- Container for answer inputs -->
  <div id="answerInputs"></div>
  
  <!-- Feedback area -->
  <div id="feedback" style="font-weight: bold; margin-top: 10px;"></div>
  
  <!-- Difficulty Panel -->
  <div id="difficulty-container">
    <h3>Select Difficulty</h3>
    <input type="radio" name="difficulty" id="difficulty-go-easy" value="easy" checked>
    <label for="difficulty-go-easy">Go Easy</label><br>
    <input type="radio" name="difficulty" id="difficulty-im-getting-there" value="mixed">
    <label for="difficulty-im-getting-there">I'm Getting There</label><br>
    <input type="radio" name="difficulty" id="difficulty-hard" value="hard">
    <label for="difficulty-hard">Hard</label><br>
  </div>
  
  <script>
    /* -----------------------------
       Global Variables and Setup
    ----------------------------- */
    let answeredCurrent = false;  // Prevent repeated scoring
    let currentQuestion = null;   // The current question object
    let currentAnswers = null;    // Expected answer(s) or keyword groups
    let score = 0;                // User score
    let mixedCount = 0;           // For "I'm Getting There" mode (2 easy : 1 hard)
    let questionPool = [];        // <-- Newly declared global variable

    // Utility: Ordinal suffix for harmonic questions
    function ordinalSuffix(n) {
      let j = n % 10, k = n % 100;
      if (j === 1 && k !== 11) return n + "st";
      if (j === 2 && k !== 12) return n + "nd";
      if (j === 3 && k !== 13) return n + "rd";
      return n + "th";
    }

    // Utility: Return a random element from an array
    function getRandom(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }

    /* -----------------------------
       Topics & Topic Checkboxes
    ----------------------------- */
    const topics = [
      "Physical quantities and units",
      "Kinematics",
      "Dynamics",
      "Forces, density and pressure",
      "Work, energy and power",
      "Deformation of solids",
      "Waves",
      "Superposition",
      "Electricity",
      "D.C. circuits",
      "Particle and nuclear physics"
    ];

    function generateTopicCheckboxes() {
      const left = document.getElementById("topic-columns-left");
      const right = document.getElementById("topic-columns-right");
      topics.forEach((name, i) => {
        const topicNum = i + 1;
        const block = `<h3>${topicNum}. ${name}</h3>
          <label><input type="checkbox" id="topic${topicNum}-defs"> Definitions</label>
          <label><input type="checkbox" id="topic${topicNum}-eqs"> Equations</label>`;
        if (i % 2 === 0) {
          left.innerHTML += block;
        } else {
          right.innerHTML += block;
        }
      });
    }

    function toggleByGroup(typeSuffix, isChecked) {
      const boxes = document.querySelectorAll(`input[id$="-${typeSuffix}"]`);
      boxes.forEach(box => box.checked = isChecked);
    }

    /* -----------------------------
       Full Question Bank
    ----------------------------- */
    const questionBank = [
      // --- Topic 1: Physical quantities and units ---
    const additionalQuestionsTopic1 = [
  {
    topic: 1,
    difficulty: "easy",
    type: "numeric_multi",
    question: function() {
      // Q1: Race conversion
      let km = (Math.random() * 10 + 5).toFixed(1); // 5.0 to 15.0 km
      let m = (km * 1000).toFixed(0);
      let cm = (km * 100000).toFixed(0);
      return {
        text: `A runner completes a race of ${km} km. Express this distance in both meters and centimeters. Explain your conversion process.`,
        answer: [m + " m", cm + " cm"],
        modelAnswer: [
          `Since 1 km = 1000 m, ${km} km equals ${m} m.`,
          `Also, 1 km = 100,000 cm, so ${km} km equals ${cm} cm.`
        ]
      };
    }
  },
  {
    topic: 1,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q2: Force conversion: Newtons to dynes
      let F = (Math.random() * 900 + 100).toFixed(0); // 100 to 1000 N
      let dynes = (F * 1e5).toFixed(0);
      return {
        text: `Convert a force of ${F} N into dynes. Explain the conversion factor used.`,
        answer: dynes + " dynes",
        modelAnswer: `1 N = 10^5 dynes, so ${F} N is equal to ${dynes} dynes.`
      };
    }
  },
  {
    topic: 1,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q3: Density conversion from kg/m³ to g/cm³.
      let densitySI = (Math.random() * 1000 + 500).toFixed(0); // 500 to 1500 kg/m³
      let densityCGS = (densitySI / 1000).toFixed(3); // 1 kg/m³ = 0.001 g/cm³
      return {
        text: `A substance has a density of ${densitySI} kg/m³. Convert this density to g/cm³. Explain the conversion.`,
        answer: densityCGS + " g/cm³",
        modelAnswer: `Since 1 kg/m³ = 0.001 g/cm³, multiplying ${densitySI} by 0.001 gives ${densityCGS} g/cm³.`
      };
    }
  },
  {
    topic: 1,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q4: Percentage uncertainty of a measurement.
      let V = (Math.random() * 450 + 50).toFixed(0); // Value between 50 and 500
      let dV = (V * (Math.random() * 0.1 + 0.01)).toFixed(1); // uncertainty 1% to 10%
      let percent = ((dV / V) * 100).toFixed(1);
      return {
        text: `A measurement yields a value of ${V} with an absolute uncertainty of ${dV}. Calculate the percentage uncertainty. Explain the calculation.`,
        answer: percent + " %",
        modelAnswer: `Percentage uncertainty = (ΔV / V) × 100 = (${dV} / ${V}) × 100 ≈ ${percent} %.`
      };
    }
  },
  {
    topic: 1,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q5: Temperature conversion from °C to K.
      let C = (Math.random() * 60 - 20).toFixed(1); // Temperature between -20°C and 40°C
      let K = (parseFloat(C) + 273.15).toFixed(2);
      return {
        text: `Convert a temperature of ${C} °C to Kelvin. Explain the conversion formula.`,
        answer: K + " K",
        modelAnswer: `To convert Celsius to Kelvin, add 273.15. Thus, ${C} °C becomes ${K} K.`
      };
    }
  }
  {
        topic: 1, difficulty: "easy", type: "equation",
        question: function() {
          const km = 3.2, m = km * 1000;
          return { 
            text: `Convert ${km} km to meters.`,
            answer: m.toFixed(0),
            modelAnswer: `We know that 1 km = 1000 m; thus, ${km} km = ${m} m.`
          };
        }
      },
      {
        topic: 1, difficulty: "easy", type: "equation",
        question: function() {
          const grams = 5000, kg = grams / 1000;
          return { 
            text: `Express ${grams} g in kilograms.`,
            answer: kg.toFixed(1),
            modelAnswer: `1 kg = 1000 g, so ${grams} g = ${kg} kg.`
          };
        }
      },
      {
        topic: 1, difficulty: "easy", type: "equation",
        question: function() {
          const km = 60, hr = 1, mps = (km * 1000) / (hr * 3600);
          return { 
            text: `A car travels ${km} km in ${hr} hour. What is its speed in m/s?`,
            answer: mps.toFixed(2),
            modelAnswer: `Speed = 60000 m / 3600 s ≈ ${mps.toFixed(2)} m/s.`
          };
        }
      },
      {
        topic: 1, difficulty: "easy", type: "equation",
        question: function() {
          const mass_g = 2000, volume_cm3 = 500;
          const density = (mass_g / 1000) / (volume_cm3 / 1e6);
          return { 
            text: `A substance has ${mass_g} g and occupies ${volume_cm3} cm³. Calculate its density in kg/m³.`,
            answer: density.toFixed(0),
            modelAnswer: `Density = mass/volume = (${mass_g/1000} kg) / (${volume_cm3/1e6} m³) ≈ ${density.toFixed(0)} kg/m³.`
          };
        }
      },
      {
        topic: 1, difficulty: "easy", type: "definition",
        question: "Define a scalar quantity.",
        modelAnswer: "A scalar quantity is described only by its magnitude.",
        keywords: [["magnitude", "size", "value"], ["no direction", "directionless"]]
      },
      {
        topic: 1, difficulty: "easy", type: "definition",
        question: "Define a vector quantity.",
        modelAnswer: "A vector quantity has both magnitude and direction.",
        keywords: [["magnitude", "size", "value"], ["direction", "oriented"]]
      },
      {
        topic: 1, difficulty: "easy", type: "definition",
        question: "Define SI base quantity.",
        modelAnswer: "An SI base quantity is defined independently and used to derive other quantities.",
        keywords: [["independent", "without reference"], ["other quantities"]]
      },
      {
        topic: 1, difficulty: "easy", type: "definition",
        question: "Define random error.",
        modelAnswer: "Random error is the unpredictable variation in measurements due to small, uncontrollable factors.",
        keywords: [["unpredictable"], ["variation", "fluctuation"], ["measurement", "reading"]]
      },
      {
        topic: 1, difficulty: "easy", type: "definition",
        question: "Define systematic error.",
        modelAnswer: "Systematic error is a consistent error that skews measurements in the same direction.",
        keywords: [["consistent", "repeated"], ["error", "bias"], ["same direction"]]
      },
      {
        topic: 1, difficulty: "easy", type: "definition",
        question: "Define precision.",
        modelAnswer: "Precision refers to how close repeated measurements are to each other.",
        keywords: [["repeatability"], ["closeness", "consistency"]]
      },
      {
        topic: 1, difficulty: "easy", type: "definition",
        question: "Define accuracy.",
        modelAnswer: "Accuracy indicates how close a measurement is to the true or accepted value.",
        keywords: [["true value"], ["correct", "actual"]]
      },
      {
        topic: 1, difficulty: "easy", type: "definition",
        question: "Define absolute uncertainty.",
        modelAnswer: "Absolute uncertainty is the margin by which a measured value may vary from the true value.",
        keywords: [["uncertainty", "error"], ["margin", "amount"]]
      },
      {
        topic: 1, difficulty: "easy", type: "definition",
        question: "Explain how to combine uncertainties for multiplication and division.",
        modelAnswer: "For multiplication or division, add the percentage uncertainties of the individual values to get the total percentage uncertainty.",
        keywords: [["add", "sum"], ["percentage uncertainty"]]
      },
      {
        topic: 1, difficulty: "hard", type: "equation",
        question: function() {
          const length = 1.20, uncertainty = 0.02;
          const perc = (uncertainty / length) * 100;
          return { 
            text: `An object is measured as ${length} m with an uncertainty of ${uncertainty} m. Calculate the percentage uncertainty.`,
            answer: perc.toFixed(2) + " %",
            modelAnswer: `Percentage uncertainty = (0.02/1.20)*100 ≈ ${perc.toFixed(2)} %.`
          };
        }
      },
      
      // --- Topic 2: Kinematics ---
      {
        topic: 2, difficulty: "easy", type: "equation",
        question: function() {
          const u = Math.floor(Math.random() * 10 + 5),
                a = Math.floor(Math.random() * 4 + 1),
                t = Math.floor(Math.random() * 4 + 2),
                s = u * t + 0.5 * a * t * t;
          return { 
            text: `A body starts at ${u} m/s and accelerates at ${a} m/s² for ${t} s. Find its displacement.`,
            answer: s.toFixed(1),
            modelAnswer: `Displacement = ut + 0.5at², so ≈ ${s.toFixed(1)} m.`
          };
        }
      },
    const additionalQuestionsTopic2 = [
  {
    topic: 2,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q1: Maximum height and time for vertical launch.
      let u = (Math.random() * 10 + 10).toFixed(1); // 10 to 20 m/s
      let g = 9.81;
      let t_max = (u / g).toFixed(2);
      let h_max = (0.5 * u * u / g).toFixed(2);
      return {
        text: `A ball is thrown vertically upwards with an initial speed of ${u} m/s. Calculate: (a) the time to reach maximum height, and (b) the maximum height. Explain your reasoning.`,
        answer: [t_max + " s", h_max + " m"],
        modelAnswer: [
          `Time to reach maximum height is t = u / g = ${u} / 9.81 ≈ ${t_max} s.`,
          `Maximum height is h = 0.5 * u² / g = 0.5 * ${u}² / 9.81 ≈ ${h_max} m.`
        ]
      };
    }
  },
  {
    topic: 2,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q2: Free fall time.
      let h = (Math.random() * 20 + 10).toFixed(1); // height between 10 and 30 m
      let g = 9.81;
      let t = (Math.sqrt(2 * h / g)).toFixed(2);
      return {
        text: `An object is dropped from a height of ${h} m. Calculate the time it takes to reach the ground. Provide your explanation.`,
        answer: t + " s",
        modelAnswer: `Using h = 0.5*g*t², solve for t: t = √(2h/g) = √(2×${h}/9.81) ≈ ${t} s.`
      };
    }
  },
  {
    topic: 2,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q3: Horizontal projectile motion.
      let h = (Math.random() * 15 + 5).toFixed(1); // 5 to 20 m
      let g = 9.81;
      let t = Math.sqrt(2 * h / g);
      let u = (Math.random() * 10 + 5).toFixed(1); // 5 to 15 m/s
      let d = (u * t).toFixed(2);
      return {
        text: `An object is launched horizontally from a cliff of height ${h} m at a speed of ${u} m/s. Calculate (a) the time to hit the ground, and (b) the horizontal distance traveled. Explain the principles involved.`,
        answer: [t.toFixed(2) + " s", d + " m"],
        modelAnswer: [
          `Time to fall: t = √(2h/g) = √(2×${h}/9.81) ≈ ${t.toFixed(2)} s.`,
          `Horizontal distance: d = u × t = ${u} × ${t.toFixed(2)} ≈ ${d} m.`
        ]
      };
    }
  },
  {
    topic: 2,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q4: Deceleration to a stop.
      let u = (Math.random() * 20 + 20).toFixed(1); // 20 to 40 m/s
      let t = (Math.random() * 3 + 2).toFixed(1); // 2 to 5 s
      let a = (u / t).toFixed(2);
      let s = (0.5 * u * t).toFixed(2);
      return {
        text: `A vehicle traveling at ${u} m/s decelerates uniformly to rest in ${t} s. Calculate (a) the deceleration and (b) the distance traveled while decelerating. Explain your calculations.`,
        answer: [a + " m/s²", s + " m"],
        modelAnswer: [
          `Deceleration a = u / t = ${u} / ${t} ≈ ${a} m/s².`,
          `Distance s = 0.5 × u × t = 0.5 × ${u} × ${t} ≈ ${s} m.`
        ]
      };
    }
  },
  {
    topic: 2,
    difficulty: "hard",
    type: "equation",
    question: function() {
      // Q5: Projectile range.
      let u = (Math.random() * 10 + 20).toFixed(1); // 20 to 30 m/s
      let angle = (Math.random() * 20 + 20).toFixed(1); // 20° to 40°
      let g = 9.81;
      let range = (u * u * Math.sin(2 * angle * Math.PI / 180) / g).toFixed(2);
      return {
        text: `A projectile is launched at ${u} m/s at an angle of ${angle}° above the horizontal. Calculate its horizontal range. Explain how the launch angle influences the range.`,
        answer: range + " m",
        modelAnswer: `Range R = (u² sin(2θ))/g. Substituting u = ${u} m/s and θ = ${angle}° gives R ≈ ${range} m. The term sin(2θ) shows that the maximum range occurs at 45°.`
      };
    }
  }
      {
        topic: 2, difficulty: "easy", type: "equation",
        question: function() {
          const m = Math.floor(Math.random() * 20 + 5),
                angle = Math.floor(Math.random() * 30 + 10),
                d = Math.floor(Math.random() * 10 + 2),
                g = 9.8,
                a = g * Math.sin(angle * Math.PI / 180),
                v = Math.sqrt(2 * a * d);
          return { 
            text: `A ${m} kg block slides down a ${angle}° frictionless slope for ${d} m. Find its speed at the bottom.`,
            answer: v.toFixed(2),
            modelAnswer: `Acceleration a ≈ ${a.toFixed(2)} m/s²; speed v ≈ ${v.toFixed(2)} m/s.`
          };
        }
      },
      {
        topic: 2, difficulty: "hard", type: "numeric_multi",
        question: function() {
          const mass = 20, angle = 23, distance = 5, g = 9.8;
          const a = g * Math.sin(angle * Math.PI / 180);
          const v = Math.sqrt(2 * a * distance);
          const ke = 0.5 * mass * v * v;
          return { 
            text: `A ${mass} kg block slides down a ${angle}° slope for ${distance} m. Calculate: (a) the acceleration, (b) the final speed, and (c) the kinetic energy.`,
            answer: [a.toFixed(2) + " m/s²", v.toFixed(2) + " m/s", ke.toFixed(2) + " J"],
            modelAnswer: [
              `a ≈ ${a.toFixed(2)} m/s²,`,
              `v ≈ ${v.toFixed(2)} m/s,`,
              `KE ≈ ${ke.toFixed(2)} J.`
            ]
          };
        }
      },
      {
        topic: 2, difficulty: "hard", type: "equation",
        question: function() {
          const u = Math.floor(Math.random() * 10 + 10),
                angle = Math.floor(Math.random() * 30 + 30),
                g = 9.8,
                R = (u * u * Math.sin(2 * angle * Math.PI / 180)) / g;
          return { 
            text: `A projectile is launched at ${angle}° with a speed of ${u} m/s. Calculate its horizontal range.`,
            answer: R.toFixed(2),
            modelAnswer: `Horizontal range R ≈ ${R.toFixed(2)} m.`
          };
        }
      },
      {
        topic: 2, difficulty: "easy", type: "equation",
        question: function() {
          const h = Math.floor(Math.random() * 20 + 10),
                g = 9.8,
                t = Math.sqrt((2 * h) / g);
          return { 
            text: `An object is launched horizontally from a height of ${h} m. Find the time to hit the ground.`,
            answer: t.toFixed(2),
            modelAnswer: `Time t ≈ ${t.toFixed(2)} s.`
          };
        }
      },
      {
        topic: 2, difficulty: "easy", type: "equation",
        question: function() {
          const t = Math.floor(Math.random() * 4 + 2),
                g = 9.8,
                s = 0.5 * g * t * t;
          return { 
            text: `An object free-falls for ${t} s. Find the distance it falls.`,
            answer: s.toFixed(1),
            modelAnswer: `Distance ≈ ${s.toFixed(1)} m.`
          };
        }
      },
      {
        topic: 2, difficulty: "easy", type: "definition",
        question: "Define displacement.",
        modelAnswer: "Displacement is the change in position of an object in a specific direction.",
        keywords: [["displacement", "distance"], ["direction", "oriented", "straight line"], ["between two points"]]
      },
      {
        topic: 2, difficulty: "easy", type: "definition",
        question: "Define speed.",
        modelAnswer: "Speed is the distance traveled per unit time taken.",
        keywords: [["distance"], ["per unit time", "divided by time"]]
      },
      {
        topic: 2, difficulty: "easy", type: "definition",
        question: "Define velocity.",
        modelAnswer: "Velocity is displacement per unit time that includes direction.",
        keywords: [["displacement"], ["per unit time"]]
      },
      {
        topic: 2, difficulty: "easy", type: "definition",
        question: "Define acceleration.",
        modelAnswer: "Acceleration is the rate at which velocity changes over time.",
        keywords: [["rate"], ["change in velocity"], ["per unit time"]]
      },
      {
        topic: 2, difficulty: "easy", type: "definition",
        question: "State what the gradient of a displacement–time graph represents.",
        modelAnswer: "It represents the velocity.",
        keywords: [["velocity"]]
      },
      {
        topic: 2, difficulty: "easy", type: "definition",
        question: "State what the gradient of a velocity–time graph represents.",
        modelAnswer: "It represents the acceleration.",
        keywords: [["acceleration"]]
      },
      {
        topic: 2, difficulty: "easy", type: "definition",
        question: "State what the area under a velocity–time graph represents.",
        modelAnswer: "It represents the displacement.",
        keywords: [["displacement"]]
      },
      
      // --- Topic 3: Dynamics ---
      const additionalQuestionsTopic3 = [
  {
    topic: 3,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q1: Net acceleration with friction.
      let m = (Math.random() * 20 + 10).toFixed(1); // 10 to 30 kg
      let F = (Math.random() * 100 + 50).toFixed(1); // 50 to 150 N
      let f = (Math.random() * F * 0.5).toFixed(1); // friction between 0 and ~50% of F
      let netForce = F - f;
      let a = (netForce / m).toFixed(2);
      return {
        text: `A force of ${F} N is applied to a ${m} kg object while a frictional force of ${f} N opposes the motion. Calculate the net acceleration. Explain the role of net force.`,
        answer: a + " m/s²",
        modelAnswer: `Net force = F - friction = ${F} N - ${f} N = ${netForce} N. Then, acceleration a = net force/m = ${netForce} / ${m} ≈ ${a} m/s².`
      };
    }
  },
  {
    topic: 3,
    difficulty: "hard",
    type: "numeric_multi",
    question: function() {
      // Q2: Elastic collision (1D).
      let m1 = (Math.random() * 5 + 1).toFixed(1); // 1 to 6 kg
      let m2 = (Math.random() * 5 + 1).toFixed(1);
      let u1 = (Math.random() * 10 + 5).toFixed(1); // 5 to 15 m/s
      let u2 = (Math.random() * 10).toFixed(1); // 0 to 10 m/s
      let v1 = (((m1 - m2) / (parseFloat(m1) + parseFloat(m2))) * u1 + (2 * m2 / (parseFloat(m1) + parseFloat(m2))) * u2).toFixed(2);
      return {
        text: `Two objects with masses ${m1} kg and ${m2} kg move at ${u1} m/s and ${u2} m/s respectively and collide elastically. Calculate the final velocity of the ${m1} kg object. Explain using momentum and energy conservation.`,
        answer: v1 + " m/s",
        modelAnswer: `Using the elastic collision formula: v₁ = [(m₁ - m₂)/(m₁ + m₂)]·u₁ + [2m₂/(m₁ + m₂)]·u₂ ≈ ${v1} m/s. This follows from conserving both momentum and kinetic energy.`
      };
    }
  },
  {
    topic: 3,
    difficulty: "easy",
    type: "numeric_multi",
    question: function() {
      // Q3: Inelastic collision.
      let m1 = (Math.random() * 10 + 5).toFixed(1); // 5 to 15 kg
      let m2 = (Math.random() * 10 + 5).toFixed(1);
      let u1 = (Math.random() * 10 + 10).toFixed(1); // 10 to 20 m/s
      let u2 = (Math.random() * 5).toFixed(1); // 0 to 5 m/s
      let finalV = ((m1 * u1 + m2 * u2) / (parseFloat(m1) + parseFloat(m2))).toFixed(2);
      return {
        text: `A ${m1} kg object traveling at ${u1} m/s collides inelastically with a ${m2} kg object moving at ${u2} m/s, and they stick together. Calculate their common final velocity. Explain momentum conservation in inelastic collisions.`,
        answer: finalV + " m/s",
        modelAnswer: `Momentum conservation gives (m₁u₁ + m₂u₂) = (m₁ + m₂)v, so v = (m₁u₁ + m₂u₂)/(m₁ + m₂) ≈ ${finalV} m/s.`
      };
    }
  },
  {
    topic: 3,
    difficulty: "hard",
    type: "equation",
    question: function() {
      // Q4: Rotational dynamics: Torque and angular acceleration.
      let F = (Math.random() * 20 + 10).toFixed(1); // 10 to 30 N
      let r = (Math.random() * 0.5 + 0.5).toFixed(2); // 0.5 to 1 m
      let I = (Math.random() * 2 + 1).toFixed(2); // 1 to 3 kg·m²
      let torque = (F * r).toFixed(2);
      let alpha = (torque / I).toFixed(2);
      return {
        text: `A force of ${F} N is applied perpendicularly at a distance of ${r} m from the axis of rotation of an object with a moment of inertia of ${I} kg·m². Calculate the angular acceleration. Explain how torque and moment of inertia determine rotational motion.`,
        answer: alpha + " rad/s²",
        modelAnswer: `Torque τ = F*r = ${F}×${r} ≈ ${torque} N·m. Angular acceleration α = τ/I = ${torque} / ${I} ≈ ${alpha} rad/s².`
      };
    }
  },
  {
    topic: 3,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q5: Block on an inclined plane with friction.
      let m = (Math.random() * 20 + 10).toFixed(1); // 10 to 30 kg
      let angle = (Math.random() * 20 + 10).toFixed(1); // 10° to 30°
      let mu = (Math.random() * 0.2 + 0.1).toFixed(2); // 0.1 to 0.3
      let g = 9.81;
      let weight = m * g;
      let parallel = weight * Math.sin(angle * Math.PI / 180);
      let friction = mu * weight * Math.cos(angle * Math.PI / 180);
      let netForce = parallel - friction;
      return {
        text: `A ${m} kg block is on an inclined plane at ${angle}° with a friction coefficient of ${mu}. Calculate the net force acting down the slope. Explain the roles of gravitational components and friction.`,
        answer: netForce.toFixed(2) + " N",
        modelAnswer: `The downhill component of weight is mg sinθ and friction is μmg cosθ. Thus, net force = mg(sinθ – μ cosθ). For m = ${m} kg, θ = ${angle}°, and μ = ${mu}, net force ≈ ${netForce.toFixed(2)} N.`
      };
    }
  }
    {
        topic: 3, difficulty: "easy", type: "equation",
        question: function() {
          const L = Math.floor(Math.random() * 5 + 1),
                W = Math.floor(Math.random() * 50 + 20),
                angle = Math.floor(Math.random() * 30 + 30),
                radians = angle * Math.PI / 180,
                T = (W * L / 2) / (L * Math.sin(radians));
          return { 
            text: `A beam of length ${L} m and weight ${W} N is supported by a string at ${angle}°. Find the tension in the string.`,
            answer: T.toFixed(1),
            modelAnswer: `Tension T ≈ ${T.toFixed(1)} N.`
          };
        }
      },
      {
        topic: 3, difficulty: "easy", type: "equation",
        question: function() {
          const m1 = 2, m2 = 3, u1 = 3, u2 = 0;
          const vf = (m1 * u1 + m2 * u2) / (m1 + m2);
          return { 
            text: `A ${m1} kg object moving at ${u1} m/s collides with a ${m2} kg object at rest. Find the final speed of the combined mass.`,
            answer: vf.toFixed(2),
            modelAnswer: `Final speed ≈ ${vf.toFixed(2)} m/s.`
          };
        }
      },
      {
        topic: 3, difficulty: "easy", type: "equation",
        question: function() {
          const m = Math.floor(Math.random() * 20 + 5),
                a = Math.floor(Math.random() * 5 + 1),
                F = m * a;
          return { 
            text: `Given a mass of ${m} kg accelerating at ${a} m/s², find the net force.`,
            answer: F.toFixed(1),
            modelAnswer: `Force F ≈ ${F.toFixed(1)} N.`
          };
        }
      },
      {
        topic: 3, difficulty: "easy", type: "equation",
        question: function() {
          const F_applied = Math.floor(Math.random() * 50 + 50),
                friction = Math.floor(Math.random() * 20 + 10),
                netF = F_applied - friction;
          return { 
            text: `A force of ${F_applied} N is applied, and friction opposes with ${friction} N. Find the net force.`,
            answer: netF.toFixed(1),
            modelAnswer: `Net force ≈ ${netF.toFixed(1)} N.`
          };
        }
      },
      {
        topic: 3, difficulty: "hard", type: "numeric_multi",
        question: function() {
          const m1 = 2, m2 = 3,
                u1 = Math.floor(Math.random() * 10 + 5),
                u2 = Math.floor(Math.random() * 10),
                v1 = ((m1 - m2) / (m1 + m2)) * u1 + ((2 * m2) / (m1 + m2)) * u2;
          return { 
            text: `In an elastic collision, a ${m1} kg object at ${u1} m/s collides with a ${m2} kg object at ${u2} m/s. Find the final speed of the ${m1} kg object.`,
            answer: v1.toFixed(2),
            modelAnswer: `Final speed ≈ ${v1.toFixed(2)} m/s.`
          };
        }
      },
      {
        topic: 3, difficulty: "hard", type: "numeric_multi",
        question: function() {
          const m1 = 2, m2 = 3, v1i = 5, v1f = 3, theta1 = 30;
          const v1fx = v1f * Math.cos(theta1 * Math.PI / 180);
          const v1fy = v1f * Math.sin(theta1 * Math.PI / 180);
          const p_initial_x = m1 * v1i;
          const p1x = m1 * v1fx;
          const v2fx = (p_initial_x - p1x) / m2;
          const v2fy = - (m1 * v1fy) / m2;
          const v2f = Math.sqrt(v2fx * v2fx + v2fy * v2fy);
          const theta2 = Math.atan2(v2fy, v2fx) * (180 / Math.PI);
          return { 
            text: `A 2 kg ball at 5 m/s collides with a 3 kg ball at rest. After collision, the 2 kg ball moves at 3 m/s at 30° above horizontal. Calculate: (a) speed and (b) angle of the 3 kg ball.`,
            answer: [v2f.toFixed(2), theta2.toFixed(2)],
            modelAnswer: [
              `Speed ≈ ${v2f.toFixed(2)} m/s,`,
              `Angle ≈ ${theta2.toFixed(2)}°.`
            ]
          };
        }
      },
      {
        topic: 3, difficulty: "easy", type: "definition",
        question: "State Newton’s First Law of Motion.",
        modelAnswer: "A body remains at rest or in uniform motion unless acted upon by a net force.",
        keywords: [["remains at rest", "constant motion"], ["no net force", "unopposed"]]
      },
      {
        topic: 3, difficulty: "easy", type: "definition",
        question: "State Newton’s Second Law of Motion.",
        modelAnswer: "The force on an object is proportional to the rate of change of its momentum.",
        keywords: [["rate of change of momentum", "change in momentum over time"]]
      },
      {
        topic: 3, difficulty: "easy", type: "definition",
        question: "State Newton’s Third Law of Motion.",
        modelAnswer: "For every action, there is an equal and opposite reaction.",
        keywords: [["equal"], ["opposite"]]
      },
      {
        topic: 3, difficulty: "easy", type: "definition",
        question: "Define inertia.",
        modelAnswer: "Inertia is the tendency of an object to resist any change in its state of motion.",
        keywords: [["resist"], ["change"], ["motion"]]
      },
      
      // --- Topic 4: Forces, density and pressure ---
      const additionalQuestionsTopic4 = [
  {
    topic: 4,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q1: Hydrostatic pressure.
      let h = (Math.random() * 10 + 5).toFixed(1); // 5 to 15 m
      let rho = 1000;
      let g = 9.81;
      let pressure = (rho * g * h).toFixed(0);
      return {
        text: `Calculate the hydrostatic pressure at a depth of ${h} m in water. Explain the formula.`,
        answer: pressure + " Pa",
        modelAnswer: `Hydrostatic pressure P = ρgh = 1000×9.81×${h} ≈ ${pressure} Pa.`
      };
    }
  },
  {
    topic: 4,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q2: Force on base of container.
      let A = (Math.random() * 1000 + 500).toFixed(0); // 500 to 1500 cm²
      let h = (Math.random() * 4 + 2).toFixed(1); // 2 to 6 m
      let rho = 1000, g = 9.81;
      let A_m2 = A / 10000;
      let force = (rho * g * h * A_m2).toFixed(1);
      return {
        text: `A container with a base area of ${A} cm² is filled with water to a height of ${h} m. Calculate the force on the base due to the water. Explain how pressure and area determine force.`,
        answer: force + " N",
        modelAnswer: `Force = Pressure × Area = ρgh × (A in m²). With A = ${A} cm² = ${A_m2.toFixed(2)} m², force ≈ ${force} N.`
      };
    }
  },
  {
    topic: 4,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q3: Buoyant force.
      let V = (Math.random() * 500 + 100).toFixed(0); // 100 to 600 cm³
      let rho = 1000, g = 9.81;
      let V_m3 = V / 1e6;
      let buoyant = (rho * g * V_m3).toFixed(2);
      return {
        text: `An object displaces ${V} cm³ of water. Calculate its buoyant force according to Archimedes' principle. Explain your reasoning.`,
        answer: buoyant + " N",
        modelAnswer: `Buoyant force F_b = ρgV. Here, V = ${V} cm³ = ${V_m3.toFixed(6)} m³, so F_b ≈ 1000×9.81×${V_m3.toFixed(6)} ≈ ${buoyant} N.`
      };
    }
  },
  {
    topic: 4,
    difficulty: "hard",
    type: "numeric_multi",
    question: function() {
      // Q4: Mixture density (adapted from past paper)
      let V_g = (Math.random() * 60 + 20).toFixed(0); // glycerine volume (20 to 80 cm³)
      let d_g = 1.3, d_w = 1.0, d_mix = 1.1;
      // Mixture: d_mix = (d_g*V_g + d_w*V_w)/(V_g+V_w) => Solve for V_w:
      let V_w = (((d_g - d_mix) / (d_mix - d_w)) * V_g).toFixed(1);
      return {
        text: `A student has ${V_g} cm³ of glycerine (density = 1.3 g/cm³). How much water (density = 1.0 g/cm³) must be added to obtain a mixture with density 1.1 g/cm³? Explain your solution.`,
        answer: V_w + " cm³",
        modelAnswer: `Let V_w be water added. Then, 1.1 = (1.3V_g + 1.0V_w)/(V_g + V_w). Solving gives V_w = ((1.3 - 1.1)/(1.1 - 1.0))×V_g = 2×V_g. Thus, if V_g = ${V_g} cm³, then V_w = ${V_w} cm³.`
      };
    }
  },
  {
    topic: 4,
    difficulty: "hard",
    type: "equation",
    question: function() {
      // Q5: Hydraulic press.
      let F_small = (Math.random() * 200 + 100).toFixed(0); // 100 to 300 N
      let A_small = (Math.random() * 50 + 50).toFixed(0); // 50 to 100 cm²
      let A_large = (Math.random() * 200 + 100).toFixed(0); // 100 to 300 cm²
      let F_large = (F_small * (A_large / A_small)).toFixed(1);
      return {
        text: `In a hydraulic press, a force of ${F_small} N is applied on a small piston of area ${A_small} cm². If the large piston has an area of ${A_large} cm², calculate the force exerted by the large piston. Explain Pascal's principle.`,
        answer: F_large + " N",
        modelAnswer: `Since pressure is transmitted equally, F_small/A_small = F_large/A_large, so F_large = F_small×(A_large/A_small) ≈ ${F_large} N.`
      };
    }
  }
    {
        topic: 4, difficulty: "easy", type: "equation",
        question: function() {
          const h = Math.floor(Math.random() * 10 + 5),
                rho = 1000, g = 9.8,
                pressure = rho * g * h;
          return { 
            text: `Calculate the hydrostatic pressure at a depth of ${h} m in water.`,
            answer: pressure.toFixed(0),
            modelAnswer: `Pressure ≈ ${pressure.toFixed(0)} Pa.`
          };
        }
      },
      {
        topic: 4, difficulty: "easy", type: "equation",
        question: function() {
          const V = Math.floor(Math.random() * 100 + 100),
                rho = 1000, g = 9.8,
                V_m3 = V / 1e6,
                F_b = rho * g * V_m3;
          return { 
            text: `An object displaces ${V} cm³ of water. Calculate the buoyant force.`,
            answer: F_b.toFixed(2),
            modelAnswer: `Buoyant force ≈ ${F_b.toFixed(2)} N.`
          };
        }
      },
      {
        topic: 4, difficulty: "easy", type: "equation",
        question: function() {
          const A = Math.floor(Math.random() * 50 + 50),
                h = Math.floor(Math.random() * 4 + 2),
                rho = 1000, g = 9.8,
                A_m2 = A / 10000,
                F = rho * g * h * A_m2;
          return { 
            text: `A container with a base area of ${A} cm² filled with water to a height of ${h} m. Calculate the force on the base.`,
            answer: F.toFixed(1),
            modelAnswer: `Force ≈ ${F.toFixed(1)} N.`
          };
        }
      },
      {
        topic: 4, difficulty: "easy", type: "definition",
        question: "Define pressure.",
        modelAnswer: "Pressure is the force exerted per unit area.",
        keywords: [["force"], ["per unit area", "divided by area"]]
      },
      {
        topic: 4, difficulty: "easy", type: "definition",
        question: "Define density.",
        modelAnswer: "Density is the mass per unit volume of a substance.",
        keywords: [["mass"], ["per unit volume", "divided by volume"]]
      },
      {
        topic: 4, difficulty: "hard", type: "numeric_multi",
        question: function() {
          const area_cm2 = 500, height = 2.5, rho = 1000, g = 9.8,
                area_m2 = area_cm2 / 10000,
                pressure = rho * g * height,
                extra = 0.1 * pressure,
                extraForce = extra * area_m2;
          return { 
            text: `A container with a base area of ${area_cm2} cm² and water height ${height} m. Calculate: (a) the hydrostatic pressure and (b) the extra force for a 10% pressure increase.`,
            answer: [pressure.toFixed(0) + " Pa", extraForce.toFixed(2) + " N"],
            modelAnswer: [
              `Pressure ≈ ${pressure.toFixed(0)} Pa,`,
              `Extra force ≈ ${extraForce.toFixed(2)} N.`
            ]
          };
        }
      },
      
      // --- Topic 5: Work, energy and power ---
    const additionalQuestionsTopic5 = [
  {
    topic: 5,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q1: Gravitational potential energy.
      let m = (Math.random() * 10 + 5).toFixed(1);
      let h = (Math.random() * 10 + 5).toFixed(1);
      let g = 9.81;
      let GPE = (m * g * h).toFixed(1);
      return {
        text: `Calculate the gravitational potential energy of a ${m} kg object raised to a height of ${h} m. Explain the concept.`,
        answer: GPE + " J",
        modelAnswer: `GPE = mgh = ${m} × 9.81 × ${h} ≈ ${GPE} J. This energy represents the work done against gravity.`
      };
    }
  },
  {
    topic: 5,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q2: Power calculation.
      let W = (Math.random() * 500 + 200).toFixed(0); // 200 to 700 J
      let t = (Math.random() * 10 + 5).toFixed(1); // 5 to 15 s
      let P = (W / t).toFixed(1);
      return {
        text: `If ${W} J of work is performed in ${t} seconds, calculate the power output. Explain the relation between work and power.`,
        answer: P + " W",
        modelAnswer: `Power P = W/t = ${W} / ${t} ≈ ${P} W, which is the rate at which work is done.`
      };
    }
  },
  {
    topic: 5,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q3: Energy stored in a spring.
      let k = (Math.random() * 200 + 100).toFixed(0); // 100 to 300 N/m
      let x = (Math.random() * 0.1 + 0.05).toFixed(3); // 0.05 to 0.15 m
      let energy = (0.5 * k * x * x).toFixed(3);
      return {
        text: `A spring with constant ${k} N/m is compressed by ${x} m. Calculate the energy stored. Explain how the energy is calculated.`,
        answer: energy + " J",
        modelAnswer: `Energy = 0.5 × k × x² = 0.5 × ${k} × (${x})² ≈ ${energy} J. This energy is stored as elastic potential energy.`
      };
    }
  },
  {
    topic: 5,
    difficulty: "hard",
    type: "equation",
    question: function() {
      // Q4: Work done against friction.
      let F = (Math.random() * 50 + 50).toFixed(0); // 50 to 100 N
      let d = (Math.random() * 10 + 5).toFixed(1); // 5 to 15 m
      let reduction = (Math.random() * 0.3 + 0.2).toFixed(2); // 20% to 50%
      let effectiveForce = F * (1 - reduction);
      let work = (effectiveForce * d).toFixed(1);
      return {
        text: `A force of ${F} N is applied to move an object over ${d} m, but friction reduces the effective force by ${ (reduction * 100).toFixed(0) }%. Calculate the net work done. Explain how friction affects work.`,
        answer: work + " J",
        modelAnswer: `Effective force = ${F}×(1 - ${reduction}) ≈ ${effectiveForce.toFixed(1)} N. Then work = effective force × distance = ${effectiveForce.toFixed(1)} × ${d} ≈ ${work} J.`
      };
    }
  },
  {
    topic: 5,
    difficulty: "hard",
    type: "equation",
    question: function() {
      // Q5: Energy conversion in free fall.
      let m = (Math.random() * 5 + 1).toFixed(1);
      let h = (Math.random() * 10 + 5).toFixed(1);
      let g = 9.81;
      let v = Math.sqrt(2 * g * h).toFixed(2);
      return {
        text: `An object of mass ${m} kg is dropped from a height of ${h} m. Using energy conservation, calculate its speed just before impact. Explain how gravitational potential energy converts to kinetic energy.`,
        answer: v + " m/s",
        modelAnswer: `Setting mgh = 0.5mv² gives v = √(2gh) = √(2×9.81×${h}) ≈ ${v} m/s, showing the conversion of potential energy to kinetic energy during free fall.`
      };
    }
  }  
    {
        topic: 5, difficulty: "easy", type: "equation",
        question: function() {
          const m = Math.floor(Math.random() * 10 + 1),
                v = Math.floor(Math.random() * 10 + 1),
                KE = 0.5 * m * v * v;
          return { 
            text: `Calculate the kinetic energy of a ${m} kg object moving at ${v} m/s.`,
            answer: KE.toFixed(1),
            modelAnswer: `KE ≈ ${KE.toFixed(1)} J.`
          };
        }
      },
      {
        topic: 5, difficulty: "easy", type: "equation",
        question: function() {
          const m = Math.floor(Math.random() * 10 + 1),
                h = Math.floor(Math.random() * 10 + 1),
                g = 9.8,
                GPE = m * g * h;
          return { 
            text: `A ${m} kg object is raised ${h} m. Calculate its gravitational potential energy.`,
            answer: GPE.toFixed(1),
            modelAnswer: `GPE ≈ ${GPE.toFixed(1)} J.`
          };
        }
      },
      {
        topic: 5, difficulty: "easy", type: "equation",
        question: function() {
          const W = Math.floor(Math.random() * 200 + 100),
                t = Math.floor(Math.random() * 10 + 1),
                P = W / t;
          return { 
            text: `If ${W} J of work is done in ${t} s, calculate the power output.`,
            answer: P.toFixed(1),
            modelAnswer: `Power ≈ ${P.toFixed(1)} W.`
          };
        }
      },
      {
        topic: 5, difficulty: "easy", type: "equation",
        question: function() {
          const F = Math.floor(Math.random() * 50 + 50),
                d = Math.floor(Math.random() * 10 + 5),
                work = F * d;
          return { 
            text: `A force of ${F} N moves an object through ${d} m. Calculate the work done.`,
            answer: work.toFixed(1),
            modelAnswer: `Work ≈ ${work.toFixed(1)} J.`
          };
        }
      },
      {
        topic: 5, difficulty: "easy", type: "definition",
        question: "State what is meant by the work done by a force.",
        modelAnswer: "Work is done when a force causes an object to move in the force’s direction.",
        keywords: [["force"], ["move", "displacement"], ["direction"]]
      },
      {
        topic: 5, difficulty: "easy", type: "definition",
        question: "Define power.",
        modelAnswer: "Power is the rate at which work is done or energy is transferred.",
        keywords: [["rate"], ["work", "energy"]]
      },
      {
        topic: 5, difficulty: "easy", type: "definition",
        question: "Use the definition of power to determine its SI base units.",
        modelAnswer: "Power (W) = work per unit time, so its SI base units are kg·m²/s³.",
        keywords: [["kg"], ["m²"], ["s^-3"]]
      },
      {
        topic: 5, difficulty: "easy", type: "definition",
        question: "Use the definition of work to determine its SI base units.",
        modelAnswer: "Work (J) = force × distance, so its SI base units are kg·m²/s².",
        keywords: [["kg"], ["m²"], ["s^-2"]]
      },
      {
        topic: 5, difficulty: "easy", type: "definition",
        question: "Use the definition of force (F = m·a) to determine its SI base units.",
        modelAnswer: "Force (N) = mass × acceleration, so its SI units are kg·m/s².",
        keywords: [["kg"], ["m/s²"]]
      },
      {
        topic: 5, difficulty: "easy", type: "definition",
        question: "Use the definition of pressure (P = F/A) to determine its SI base units.",
        modelAnswer: "Pressure (Pa) = force per unit area, so its SI units are kg/(m·s²).",
        keywords: [["kg"], ["m"], ["s^-2"]]
      },
      {
        topic: 5, difficulty: "easy", type: "definition",
        question: "Use the definition of momentum (p = m·v) to determine its SI base units.",
        modelAnswer: "Momentum has SI units of kg·m/s.",
        keywords: [["kg"], ["m/s"]]
      },
      {
        topic: 5, difficulty: "easy", type: "definition",
        question: "Use the definition of strain to determine its SI base units.",
        modelAnswer: "Strain is a ratio of lengths and is dimensionless.",
        keywords: [["dimensionless"], ["no units"]]
      },
      {
        topic: 5, difficulty: "hard", type: "numeric_multi",
        question: function() {
          const Vin = 9.0, R_fixed = 1800, V_fixed = 5.4;
          const I = V_fixed / R_fixed;
          const V_LDR = Vin - V_fixed;
          const R_LDR = V_LDR / I;
          return { 
            text: `A ${Vin} V battery (ideal) is connected in series with an LDR and a ${R_fixed} Ω resistor. The voltmeter across the fixed resistor reads ${V_fixed} V. Calculate: (a) the current and (b) the resistance of the LDR.`,
            answer: [I.toFixed(3) + " A", R_LDR.toFixed(0) + " Ω"],
            modelAnswer: [
              `I ≈ ${I.toFixed(3)} A,`,
              `R_LDR ≈ ${R_LDR.toFixed(0)} Ω.`
            ]
          };
        }
      },
      
      // --- Topic 6: Deformation of solids ---
    const additionalQuestionsTopic6 = [
  {
    topic: 6,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q1: Spring extension via Hooke’s law.
      let k = (Math.random() * 200 + 100).toFixed(0); // 100 to 300 N/m
      let F = (Math.random() * 50 + 20).toFixed(0); // 20 to 70 N
      let extension = (F / k).toFixed(3);
      return {
        text: `A spring with constant ${k} N/m is subjected to a force of ${F} N. Calculate the extension using Hooke's law. Explain the principle.`,
        answer: extension + " m",
        modelAnswer: `Hooke's law: F = kx, so x = F/k = ${F} / ${k} ≈ ${extension} m.`
      };
    }
  },
  {
    topic: 6,
    difficulty: "hard",
    type: "equation",
    question: function() {
      // Q2: Tensile extension of a rod.
      let L = (Math.random() * 100 + 50).toFixed(0); // 50 to 150 cm
      let A = (Math.random() * 0.001 + 0.0005).toFixed(6); // approx. 0.0005 to 0.0015 m²
      let F = (Math.random() * 1000 + 500).toFixed(0); // 500 to 1500 N
      let E = 200e9; // 200 GPa (steel)
      let strain = F / (E * A);
      let extension = ((L / 100) * strain).toFixed(6); // L in m
      return {
        text: `A rod of length ${L} cm and cross-sectional area ${A} m² is subjected to a tensile force of ${F} N. Given Young's modulus E = 200 GPa, calculate the extension. Explain the relation between stress, strain, and Young’s modulus.`,
        answer: extension + " m",
        modelAnswer: `Stress = F/A, strain = stress/E, and extension = original length × strain. Thus, extension = (L/100)×(F/(E*A)) ≈ ${extension} m.`
      };
    }
  },
  {
    topic: 6,
    difficulty: "hard",
    type: "equation",
    question: function() {
      // Q3: Energy stored in a deformed material (approximation).
      let F = (Math.random() * 500 + 100).toFixed(0); // 100 to 600 N
      let k_approx = (Math.random() * 100 + 200).toFixed(0); // approximate stiffness
      let x = (F / k_approx).toFixed(3);
      let energy = (0.5 * F * x).toFixed(2);
      return {
        text: `A material obeying Hooke's law has an approximate stiffness of ${k_approx} N/m. If a force of ${F} N produces an extension of ${x} m, calculate the elastic potential energy stored. Explain your calculation.`,
        answer: energy + " J",
        modelAnswer: `Elastic potential energy U = 0.5 × F × x. So, U = 0.5 × ${F} × ${x} ≈ ${energy} J, representing the energy stored during deformation.`
      };
    }
  },
  {
    topic: 6,
    difficulty: "easy",
    type: "definition",
    question: "Define Young's modulus and explain its significance in the deformation of materials.",
    modelAnswer: "Young's modulus is the ratio of stress to strain in the elastic region of a material. It measures the stiffness of a material and indicates how much it will deform under a given load.",
    keywords: [["stiffness"], ["stress", "strain"], ["elastic"]]
  },
  {
    topic: 6,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q5: Strain calculation.
      let deltaL = (Math.random() * 0.05 + 0.01).toFixed(3); // 0.01 to 0.06 m
      let L0 = (Math.random() * 1 + 1).toFixed(2); // 1 to 2 m
      let strain = (deltaL / L0).toFixed(3);
      return {
        text: `A rod of original length ${L0} m is extended by ${deltaL} m. Calculate the strain. Explain what strain represents.`,
        answer: strain,
        modelAnswer: `Strain = ΔL / L₀ = ${deltaL} / ${L0} ≈ ${strain}. It is a dimensionless measure of deformation.`
      };
    }
  }  
    {
        topic: 6, difficulty: "easy", type: "equation",
        question: function() {
          const stress = Math.floor(Math.random() * 10 + 5),
                strain = Math.random() * 0.01 + 0.001,
                E = stress / strain;
          return { 
            text: `A material has a stress of ${stress} MPa and a strain of ${strain.toFixed(4)}. Calculate its Young's modulus in GPa.`,
            answer: (E / 1000).toFixed(2),
            modelAnswer: `E ≈ ${(E).toFixed(2)} MPa, which is ≈ ${(E / 1000).toFixed(2)} GPa.`
          };
        }
      },
      {
        topic: 6, difficulty: "easy", type: "equation",
        question: function() {
          const k = Math.floor(Math.random() * 200 + 100),
                F = Math.floor(Math.random() * 50 + 10),
                extension = F / k;
          return { 
            text: `A spring with constant ${k} N/m is pulled by a force of ${F} N. Calculate its extension.`,
            answer: extension.toFixed(3),
            modelAnswer: `Extension ≈ ${extension.toFixed(3)} m (by Hooke's law).`
          };
        }
      },
      {
        topic: 6, difficulty: "easy", type: "equation",
        question: function() {
          const L0 = Math.floor(Math.random() * 50 + 50),
                ext = (Math.floor(Math.random() * 5 + 1)) / 100,
                strain = ext / (L0 / 100);
          return { 
            text: `A rod of length ${L0} cm is extended by ${ext.toFixed(2)} m. Calculate the strain.`,
            answer: strain.toFixed(3),
            modelAnswer: `Strain ≈ ${strain.toFixed(3)} (dimensionless).`
          };
        }
      },
      {
        topic: 6, difficulty: "easy", type: "definition",
        question: "State Hooke's Law.",
        modelAnswer: "Within the elastic limit, the extension of a spring is directly proportional to the applied force.",
        keywords: [["extension", "stretch"], ["proportional"], ["force"]]
      },
      {
        topic: 6, difficulty: "easy", type: "definition",
        question: "Define stress.",
        modelAnswer: "Stress is the force applied per unit cross-sectional area of a material.",
        keywords: [["force"], ["per unit", "divided by"], ["cross-sectional area", "area"]]
      },
      {
        topic: 6, difficulty: "easy", type: "definition",
        question: "Define strain.",
        modelAnswer: "Strain is the ratio of the change in length to the original length.",
        keywords: [["ratio"], ["change in length"], ["original length"]]
      },
      {
        topic: 6, difficulty: "hard", type: "numeric_multi",
        question: function() {
          const length = 2, area = 1e-4, force = 10000, E = 200e9;
          const stress = force / area;
          const strain = stress / E;
          const elongation = length * strain;
          return { 
            text: `A rod of length ${length} m and area ${area} m² is subjected to a force of ${force} N. With E = ${E / 1e9} GPa, calculate: (a) stress in Pa, (b) strain, and (c) elongation in m.`,
            answer: [stress.toExponential(2) + " Pa", strain.toExponential(2), elongation.toExponential(2) + " m"],
            modelAnswer: [
              `Stress ≈ ${stress.toExponential(2)} Pa,`,
              `Strain ≈ ${strain.toExponential(2)},`,
              `Elongation ≈ ${elongation.toExponential(2)} m.`
            ]
          };
        }
      },
      
      // --- Topic 7: Waves ---
    const additionalQuestionsTopic7 = [
  {
    topic: 7,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q1: Wave speed on a string.
      let T = (Math.random() * 20 + 50).toFixed(1); // 50 to 70 N
      let mu = (Math.random() * 0.005 + 0.005).toFixed(4); // 0.005 to 0.010 kg/m
      let v = Math.sqrt(T / mu).toFixed(2);
      return {
        text: `A wave travels along a string under a tension of ${T} N with a linear density of ${mu} kg/m. Calculate the speed of the wave. Explain the relationship.`,
        answer: v + " m/s",
        modelAnswer: `Wave speed v = √(T/μ). Thus, v = √(${T} / ${mu}) ≈ ${v} m/s.`
      };
    }
  },
  {
    topic: 7,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q2: Wavelength from frequency.
      let v = (Math.random() * 50 + 300).toFixed(1); // 300 to 350 m/s
      let f = (Math.random() * 10 + 50).toFixed(1); // 50 to 60 Hz
      let lambda = (v / f).toFixed(2);
      return {
        text: `A sound wave has a speed of ${v} m/s and a frequency of ${f} Hz. Calculate its wavelength. Explain the connection between these quantities.`,
        answer: lambda + " m",
        modelAnswer: `Wavelength λ = v / f = ${v} / ${f} ≈ ${lambda} m.`
      };
    }
  },
  {
    topic: 7,
    difficulty: "hard",
    type: "equation",
    question: function() {
      // Q4: Doppler effect for a moving source.
      let f0 = (Math.random() * 10 + 400).toFixed(1); // 400 to 410 Hz
      let v = 340; // m/s
      let vs = (Math.random() * 10 + 10).toFixed(1); // 10 to 20 m/s
      let f_obs = (f0 * (v / (v - vs))).toFixed(1);
      return {
        text: `A source emitting sound at ${f0} Hz moves towards a stationary observer at ${vs} m/s. Calculate the observed frequency using the Doppler effect. Explain your reasoning.`,
        answer: f_obs + " Hz",
        modelAnswer: `For a source moving toward an observer, f = f₀×(v/(v−vs)). Here, f ≈ ${f0}×(340/(340−${vs})) ≈ ${f_obs} Hz.`
      };
    }
  },
  {
    topic: 7,
    difficulty: "hard",
    type: "equation",
    question: function() {
      // Q5: Standing wave in a tube.
      let L = (Math.random() * 1 + 1).toFixed(1); // 1 to 2 m
      let n = Math.floor(Math.random() * 3 + 1); // harmonic number 1 to 3
      let v = (Math.random() * 50 + 330).toFixed(1); // 330 to 380 m/s
      let lambda = (2 * L / n).toFixed(2);
      let f = (v / lambda).toFixed(2);
      return {
        text: `An open tube of length ${L} m supports a standing wave in its ${n} harmonic mode. Given the speed of sound is ${v} m/s, calculate (a) the wavelength and (b) the frequency of the standing wave. Explain your derivation.`,
        answer: [lambda + " m", f + " Hz"],
        modelAnswer: [
          `For an open tube, λ = 2L/n, so λ = 2×${L}/${n} ≈ ${lambda} m.`,
          `Frequency f = v/λ = ${v} / ${lambda} ≈ ${f} Hz.`
        ]
      };
    }
  }  
    {
        topic: 7, difficulty: "easy", type: "equation",
        question: function() {
          const n = Math.floor(Math.random() * 3 + 1),
                L = Math.floor(Math.random() * 3 + 1),
                v = Math.floor(Math.random() * 200 + 100),
                f = (n * v) / (2 * L);
          return { 
            text: `A pipe closed at both ends of length ${L} m vibrates in its ${ordinalSuffix(n)} harmonic. Find its frequency.`,
            answer: f.toFixed(1),
            modelAnswer: `Frequency ≈ ${f.toFixed(1)} Hz (using f = n*v/(2*L)).`
          };
        }
      },
      {
        topic: 7, difficulty: "easy", type: "equation",
        question: function() {
          const d = (Math.floor(Math.random() * 4 + 1)) / 1000,
                D = Math.floor(Math.random() * 100 + 100),
                x = (Math.floor(Math.random() * 20 + 10)) / 1000,
                lambda = (d * x) / (D / 100);
          return { 
            text: `In a two-slit experiment with a slit separation of ${(d * 1000).toFixed(1)} mm, screen distance ${D} cm, and fringe spacing ${(x * 1000).toFixed(1)} mm, calculate the wavelength of light.`,
            answer: (lambda * 1e9).toFixed(6) + " m",
            modelAnswer: `Using λ = (d×x)/(D/100), λ ≈ ${(lambda * 1e9).toFixed(6)} m.`
          };
        }
      },
      {
        topic: 7, difficulty: "easy", type: "equation",
        question: function() {
          const L = Math.floor(Math.random() * 3 + 1),
                v = Math.floor(Math.random() * 100 + 300),
                f = v / (2 * L),
                T = 1 / f;
          return { 
            text: `A pipe open at both ends of length ${L} m vibrates. (a) Find the fundamental frequency and (b) the time period.`,
            answer: [f.toFixed(1), T.toFixed(3)],
            modelAnswer: `Fundamental frequency ≈ ${f.toFixed(1)} Hz; Time period ≈ ${T.toFixed(3)} s.`,
            type: "numeric_multi",
            multi: true
          };
        }
      },
      {
        topic: 7, difficulty: "easy", type: "definition",
        question: "Define wavelength.",
        modelAnswer: "Wavelength is the distance between successive points on a wave that are in phase.",
        keywords: [["distance"], ["successive"], ["in phase"]]
      },
      {
        topic: 7, difficulty: "easy", type: "definition",
        question: "Define frequency.",
        modelAnswer: "Frequency is the number of oscillations per second.",
        keywords: [["oscillations"], ["per second", "Hz"]]
      },
      {
        topic: 7, difficulty: "easy", type: "definition",
        question: "Define wavefront.",
        modelAnswer: "A wavefront is a line that connects points on a wave that are in the same phase.",
        keywords: [["line"], ["same phase"]]
      },
      {
        topic: 7, difficulty: "hard", type: "numeric_multi",
        question: function() {
          const L = 2, v = 305, f = v / (4 * L), T = 1 / f;
          return { 
            text: `A pipe closed at one end of length ${L} m vibrates. Calculate: (a) its fundamental frequency, (b) its time period, and (c) verify that f×T ≈ 1.`,
            answer: [f.toFixed(1), T.toFixed(3), (f * T).toFixed(2)],
            modelAnswer: [
              `Fundamental frequency ≈ ${f.toFixed(1)} Hz,`,
              `Time period ≈ ${T.toFixed(3)} s,`,
              `f×T ≈ ${(f * T).toFixed(2)} (≈1).`
            ],
            multi: true
          };
        }
      },
      // New definition: Standing Wave
      {
        topic: 7, difficulty: "easy", type: "definition",
        question: "Define a standing wave.",
        modelAnswer: "A standing wave is formed by the combination of two waves moving in opposite directions with similar amplitude and the same frequency.",
        keywords: [["two waves"], ["opposite directions"], ["similar amplitude"], ["same frequency", "coherent"]]
      },
      // New question: Open Pipe Standing Wave
      {
        topic: 7, difficulty: "hard", type: "numeric_multi",
        question: function() {
          const L = Math.floor(Math.random() * 3 + 1);
          const n = Math.floor(Math.random() * 3 + 1);
          const v = Math.floor(Math.random() * 50 + 330);
          const lambda = (2 * L) / n;
          const f = v / lambda;
          return {
            text: `An open pipe of length ${L} m vibrates in its ${n}${ordinalSuffix(n)} harmonic mode. Given the speed of sound is ${v} m/s, calculate: (a) the wavelength and (b) the frequency of the standing wave.`,
            answer: [lambda.toFixed(2) + " m", f.toFixed(2) + " Hz"],
            modelAnswer: [
              `Wavelength λ = 2L/n = 2×${L}/${n} ≈ ${lambda.toFixed(2)} m,`,
              `Frequency f = v/λ = ${v}/${lambda.toFixed(2)} ≈ ${f.toFixed(2)} Hz.`
            ]
          };
        }
      },
      // New question: Speaker-Microphone Setup
      {
        topic: 7, difficulty: "hard", type: "equation",
        question: function() {
          const d = (Math.random() * 0.5 + 0.2).toFixed(2);
          const v = Math.floor(Math.random() * 50 + 330);
          const f = v / (2 * d);
          return {
            text: `A speaker faces a wall with a microphone between them. The microphone, when moved, passes through loud points spaced ${d} m apart. If the speed of sound is ${v} m/s, calculate the frequency.`,
            answer: f.toFixed(2) + " Hz",
            modelAnswer: `Loud point spacing is half a wavelength, so λ = 2×${d} = ${(2 * d).toFixed(2)} m; then f = ${v} / (${2 * d}) ≈ ${f.toFixed(2)} Hz.`
          };
        }
      },
      // New question: Diffraction Grating
      {
        topic: 7, difficulty: "hard", type: "equation",
        question: function() {
          const d = (Math.random() * 0.00001 + 0.000005).toFixed(7);
          const m = Math.floor(Math.random() * 3) + 1;
          const theta = Math.floor(Math.random() * 30 + 10);
          const lambda = (d * Math.sin(theta * Math.PI / 180)) / m;
          return {
            text: `A diffraction grating has a spacing of ${d} m. A bright fringe of order ${m} is seen at ${theta}°. Calculate the wavelength.`,
            answer: lambda.toFixed(7) + " m",
            modelAnswer: `Using d*sinθ = nλ, we have λ = ${d}*sin(${theta}°)/${m} ≈ ${lambda.toFixed(7)} m (Note: If the grating specification is given in lines per mm, convert it to d in meters first.)`
          };
        }
      },

     // --- Topic 8: superposition ---
    const additionalQuestionsTopic8 = [
        {
    topic: 8,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q1: Constructive interference.
      let A = Math.floor(Math.random() * 5 + 3); // Amplitude A between 3 and 7
      let B = Math.floor(Math.random() * 5 + 2); // Amplitude B between 2 and 6
      let resultant = A + B;
      return {
        text: Two waves interfere constructively. If one wave has an amplitude of ${A} units and the other ${B} units, what is the resultant amplitude?, 
        answer: resultant.toString(),
        modelAnswer: In constructive interference, the amplitudes simply add together. Therefore, the resultant amplitude is ${A} + ${B} = ${resultant} units.
      };
    }
  },
   {
    topic: 8,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q2: Destructive interference.
      let A = Math.floor(Math.random() * 5 + 3);
      let B = Math.floor(Math.random() * 5 + 2);
      let resultant = Math.abs(A - B);
      return {
        text: Two waves interfere destructively. If one wave has an amplitude of ${A} units and the other ${B} units, what is the resultant amplitude?, 
        answer: resultant.toString(),
        modelAnswer: In destructive interference, the waves partially cancel out. The resultant amplitude is the absolute difference: |${A} - ${B}| = ${resultant} units.
      };
    }
  },
      const additionalQuestionsTopic8 = [
  {
    topic: 8,
    difficulty: "easy",
    type: "definition",
    question: "State the principle of superposition.",
    modelAnswer: "The principle of superposition states that when waves overlap, the resultant displacement is the sum of the individual displacements.",
    keywords: [["sum", "total"], ["displacement", "overlap"]]
  },
  {
    topic: 8,
    difficulty: "easy",
    type: "definition",
    question: "Define constructive interference.",
    modelAnswer: "Constructive interference occurs when waves in phase add together, increasing the overall amplitude.",
    keywords: [["in phase"], ["add", "reinforce", "increase"]]
  },
  {
    topic: 8,
    difficulty: "easy",
    type: "definition",
    question: "Define destructive interference.",
    modelAnswer: "Destructive interference occurs when waves are out of phase, causing them to cancel each other out.",
    keywords: [["out of phase"], ["cancel", "reduce"]]
  }
];

  // --- Topic 9: Electricity ---
   const additionalQuestionsTopic9 = [
  {
    topic: 9,
    difficulty: "easy",
    type: "equation",
    question: function() {
      const I = Math.floor(Math.random() * 5 + 1),
            R = Math.floor(Math.random() * 20 + 10),
            V = I * R;
      return {
        text: `A current of ${I} A flows through a resistor of ${R} Ω. Calculate the voltage across it and explain how Ohm's law is used.`,
        answer: V.toFixed(1),
        modelAnswer: `Using Ohm's law (V = I×R), we have V = ${I} × ${R} ≈ ${V.toFixed(1)} V.`
      };
    }
  },
  {
    topic: 9,
    difficulty: "easy",
    type: "equation",
    question: function() {
      const V = Math.floor(Math.random() * 20 + 10),
            I = Math.floor(Math.random() * 5 + 1),
            P = V * I;
      return {
        text: `For a circuit with a voltage of ${V} V and a current of ${I} A, calculate the power and describe the calculation process.`,
        answer: P.toFixed(1),
        modelAnswer: `Power is calculated using P = V × I. Therefore, P = ${V} × ${I} ≈ ${P.toFixed(1)} W.`
      };
    }
  },
  {
    topic: 9,
    difficulty: "easy",
    type: "equation",
    question: function() {
      const R1 = Math.floor(Math.random() * 20 + 10),
            R2 = Math.floor(Math.random() * 20 + 10),
            R3 = Math.floor(Math.random() * 20 + 10),
            Rp = 1 / (1 / R1 + 1 / R2),
            R_total = Rp + R3;
      return {
        text: `Calculate the total resistance of two resistors (${R1} Ω and ${R2} Ω) in parallel, in series with a ${R3} Ω resistor.`,
        answer: R_total.toFixed(1),
        modelAnswer: `For the parallel pair: R_parallel = 1/(1/${R1} + 1/${R2}) ≈ ${Rp.toFixed(1)} Ω. Then, R_total = R_parallel + ${R3} = ${Rp.toFixed(1)} + ${R3} ≈ ${R_total.toFixed(1)} Ω.`
      };
    }
  },
  {
    topic: 9,
    difficulty: "easy",
    type: "definition",
    question: "Define electric current.",
    modelAnswer: "Electric current is the rate at which electric charge flows through a conductor.",
    keywords: [["rate", "flow"], ["charge"]]
  },
  {
    topic: 9,
    difficulty: "easy",
    type: "definition",
    question: "Define electromotive force (e.m.f.).",
    modelAnswer: "Electromotive force (e.m.f.) is the energy provided per unit charge by a source, measured in volts.",
    keywords: [["work done"], ["per unit charge"]]
  },
  {
    topic: 9,
    difficulty: "easy",
    type: "definition",
    question: "Define electric potential difference.",
    modelAnswer: "Electric potential difference is the work required per unit charge to move a charge between two points.",
    keywords: [["work", "work done"], ["per unit charge"], ["between two points"]]
  },
  {
    topic: 9,
    difficulty: "hard",
    type: "numeric_multi",
    question: function() {
      const R = 10, 
            Vin = 12, 
            I1 = Vin / R, 
            P1 = I1 * I1 * R,
            R_series = 10, 
            newTotal = R + R_series, 
            I2 = Vin / newTotal;
      return {
        text: `A resistor of ${R} Ω is connected to a ${Vin} V battery. Calculate: (a) the current, (b) the power, and (c) the new current if a ${R_series} Ω resistor is added in series.`,
        answer: [I1.toFixed(2) + " A", P1.toFixed(1) + " W", I2.toFixed(2) + " A"],
        modelAnswer: [
          `Current I = V / R = ${Vin} / ${R} = ${I1.toFixed(2)} A.`,
          `Power P = I² × R = (${I1.toFixed(2)})² × ${R} ≈ ${P1.toFixed(1)} W.`,
          `With an additional resistor of ${R_series} Ω, new current I = ${Vin} / (${R} + ${R_series}) = ${I2.toFixed(2)} A.`
        ]
      };
    }
  }
];
        // --- Topic 10: DC ---
   const additionalQuestionsTopic10 = [
  {
    topic: 10,
    difficulty: "easy",
    type: "equation",
    question: function() {
      const R1 = Math.floor(Math.random() * 50 + 50),
            R2 = Math.floor(Math.random() * 50 + 50),
            Vin = Math.floor(Math.random() * 20 + 10),
            Vout = Vin * (R2 / (R1 + R2));
      return {
        text: `In a voltage divider with resistors of ${R1} Ω and ${R2} Ω and an input voltage of ${Vin} V, find the voltage across the ${R2} Ω resistor.`,
        answer: Vout.toFixed(1),
        modelAnswer: `Using the voltage divider rule: V_out = Vin × (R2 / (R1 + R2)). Thus, V_out ≈ ${Vout.toFixed(1)} V.`
      };
    }
  },
  {
    topic: 10,
    difficulty: "easy",
    type: "equation",
    question: function() {
      const Vin = Math.floor(Math.random() * 20 + 10),
            R_total = Math.floor(Math.random() * 100 + 100),
            I = Vin / R_total;
      return {
        text: `Find the current in a series circuit with a total resistance of ${R_total} Ω and a supply voltage of ${Vin} V.`,
        answer: I.toFixed(2),
        modelAnswer: `Using Ohm's law, I = V / R. With V = ${Vin} V and R = ${R_total} Ω, I ≈ ${I.toFixed(2)} A.`
      };
    }
  },
  {
    topic: 10,
    difficulty: "easy",
    type: "equation",
    question: function() {
      const I = Math.floor(Math.random() * 5 + 1),
            R = Math.floor(Math.random() * 100 + 50),
            P = I * I * R;
      return {
        text: `Calculate the power dissipated in a ${R} Ω resistor with a current of ${I} A.`,
        answer: P.toFixed(1),
        modelAnswer: `Power is given by P = I² × R. So, P = ${I}² × ${R} ≈ ${P.toFixed(1)} W.`
      };
    }
  },
  {
    topic: 10,
    difficulty: "easy",
    type: "equation",
    question: function() {
      const R1 = Math.floor(Math.random() * 50 + 50),
            R2 = Math.floor(Math.random() * 50 + 50),
            R3 = Math.floor(Math.random() * 50 + 50),
            R_total = R1 + R2 + R3;
      return {
        text: `Three resistors of ${R1} Ω, ${R2} Ω, and ${R3} Ω are connected in series. Find the total resistance.`,
        answer: R_total.toFixed(1),
        modelAnswer: `In a series circuit, resistances add: R_total = ${R1} + ${R2} + ${R3} = ${R_total} Ω.`
      };
    }
  },
  {
    topic: 10,
    difficulty: "hard",
    type: "numeric_multi",
    question: function() {
      const R1 = 100,
            R2 = 200,
            R3 = 300,
            Vin = 12,
            R_total = R1 + R2 + R3,
            I = Vin / R_total,
            V_R2 = I * R2,
            power_R2 = (V_R2 * V_R2) / R2;
      return {
        text: `In a voltage divider circuit with resistors ${R1} Ω, ${R2} Ω, and ${R3} Ω connected in series and an input voltage of ${Vin} V, calculate: (a) the voltage across the ${R2} Ω resistor, and (b) the power dissipated in it.`,
        answer: [V_R2.toFixed(2) + " V", power_R2.toFixed(2) + " W"],
        modelAnswer: [
          `Voltage across ${R2} Ω, V_R2 = Vin × (R2 / (R1 + R2 + R3)) ≈ ${V_R2.toFixed(2)} V.`,
          `Power dissipated in ${R2} Ω = V_R2² / R2 ≈ ${power_R2.toFixed(2)} W.`
        ]
      };
    }
  },
  {
    topic: 10,
    difficulty: "easy",
    type: "definition",
    question: "Define resistance.",
    modelAnswer: "Resistance is defined as the ratio of the voltage across a conductor to the current flowing through it.",
    keywords: [["voltage"], ["current"], ["ratio"]]
  },
  {
    topic: 10,
    difficulty: "easy",
    type: "definition",
    question: "Define internal resistance.",
    modelAnswer: "Internal resistance is the resistance within a power source that causes a drop in the terminal voltage.",
    keywords: [["internal"], ["power source"], ["resistance"]]
  }
];

      // --- Topic 11: Particle and nuclear physics ---
      const additionalQuestionsTopic11 = [
  {
    topic: 11,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q1: Alpha decay.
      let A = Math.floor(Math.random() * 50 + 200); // 200 to 250
      let finalA = A - 4;
      return {
        text: `A nucleus with a mass number of ${A} undergoes alpha decay. Calculate its final mass number and explain the process.`,
        answer: finalA.toString(),
        modelAnswer: `Alpha decay emits an alpha particle (2 protons + 2 neutrons), reducing the mass number by 4: ${A} - 4 = ${finalA}.`
      };
    }
  },
  {
    topic: 11,
    difficulty: "easy",
    type: "equation",
    question: function() {
      // Q2: Beta-minus decay.
      let Z = Math.floor(Math.random() * 20 + 10); // 10 to 30
      let A = Math.floor(Math.random() * 30 + parseFloat(Z) + 10);
      let finalZ = Z + 1;
      return {
        text: `A nucleus with proton number ${Z} and mass number ${A} undergoes beta-minus decay. Calculate the final proton number and explain the process.`,
        answer: finalZ.toString(),
        modelAnswer: `Beta-minus decay converts a neutron into a proton, increasing the proton number by 1 (mass number remains unchanged): Final Z = ${Z} + 1 = ${finalZ}.`
      };
    }
  }
    {
        topic: 11, difficulty: "easy", type: "equation",
        question: function() {
          const initialN = Math.floor(Math.random() * 50 + 50);
          return { 
            text: `In β– decay, if a nucleus has a nucleon number of ${initialN}, what remains?`,
            answer: initialN.toString(),
            modelAnswer: `It remains ${initialN}.`
          };
        }
      },
      {
        topic: 11, difficulty: "easy", type: "equation",
        question: function() {
          const initialZ = Math.floor(Math.random() * 20 + 10),
                finalZ = initialZ - 1;
          return { 
            text: `A nucleus with a proton number of ${initialZ} undergoes β+ decay. What is its new proton number?`,
            answer: finalZ.toString(),
            modelAnswer: `It becomes ${finalZ}.`
          };
        }
      },
      {
        topic: 11, difficulty: "easy", type: "equation",
        question: function() {
          const initialMass = Math.floor(Math.random() * 200 + 100),
                finalMass = initialMass - 4;
          return { 
            text: `A nucleus with mass number ${initialMass} undergoes alpha decay. What is its new mass number?`,
            answer: finalMass.toString(),
            modelAnswer: `It becomes ${finalMass}.`
          };
        }
      },
      {
        topic: 11, difficulty: "easy", type: "equation",
        question: function() {
          const initialMass = Math.floor(Math.random() * 200 + 100),
                change = 4;
          return { 
            text: `A nucleus with mass number ${initialMass} undergoes alpha decay. By how much does its mass number change?`,
            answer: change.toString(),
            modelAnswer: `It decreases by 4.`
          };
        }
      },
      {
        topic: 11, difficulty: "easy", type: "definition",
        question: "Define nucleon number.",
        modelAnswer: "Nucleon number is the total number of protons and neutrons in a nucleus.",
        keywords: [["protons"], ["neutrons"], ["total"]]
      },
      {
        topic: 11, difficulty: "easy", type: "definition",
        question: "Define proton number.",
        modelAnswer: "Proton number is the count of protons in a nucleus.",
        keywords: [["proton"], ["number"]]
      },
      {
        topic: 11, difficulty: "easy", type: "definition",
        question: "Define isotope.",
        modelAnswer: "Isotopes are atoms of the same element with the same number of protons but different numbers of neutrons.",
        keywords: [["same protons"], ["different neutrons"]]
      },
      {
        topic: 11, difficulty: "easy", type: "definition",
        question: "Define a hadron.",
        modelAnswer: "A hadron is a composite particle made of quarks that interacts via the strong nuclear force.",
        keywords: [["quarks"], ["strong force"]]
      },
      {
        topic: 11, difficulty: "easy", type: "definition",
        question: "Define a baryon.",
        modelAnswer: "A baryon is a hadron composed of three quarks.",
        keywords: [["three quarks"]]
      },
      {
        topic: 11, difficulty: "easy", type: "definition",
        question: "Define a meson.",
        modelAnswer: "A meson is a hadron composed of a quark and an antiquark.",
        keywords: [["quark"], ["antiquark"]]
      },
      {
        topic: 11, difficulty: "easy", type: "definition",
        question: "Define a lepton.",
        modelAnswer: "A lepton is a fundamental particle that does not participate in the strong nuclear force.",
        keywords: [["fundamental"], ["no strong force"]]
      },
      {
        topic: 11, difficulty: "easy", type: "definition",
        question: "Define a quark.",
        modelAnswer: "A quark is a fundamental particle that comes in flavors such as up, down, charm, strange, top, and bottom.",
        keywords: [["up"], ["down"], ["charm"], ["strange"], ["top"], ["bottom"]]
      },
      {
        topic: 11, difficulty: "easy", type: "definition",
        question: "State the charges of up and down quarks.",
        modelAnswer: "The up quark has a charge of +2/3 e, while the down quark has a charge of -1/3 e.",
        keywords: [[ "+2/3", "2/3" ], [ "-1/3", "1/3" ]]
      },
      {
        topic: 11, difficulty: "easy", type: "definition",
        question: "State the quark composition of a proton.",
        modelAnswer: "A proton is composed of two up quarks and one down quark (uud).",
        keywords: [["2 up", "two up"], ["1 down", "uud"]]
      },
      {
        topic: 11, difficulty: "easy", type: "definition",
        question: "State the quark composition of a neutron.",
        modelAnswer: "A neutron is composed of one up quark and two down quarks (udd).",
        keywords: [["1 up"], ["2 down"], ["udd"]]
      },
      {
        topic: 11, difficulty: "easy", type: "definition",
        question: "Define an antiparticle.",
        modelAnswer: "An antiparticle has the same mass as its corresponding particle but an opposite charge.",
        keywords: [["same mass"], ["opposite charge"]]
      },
      {
        topic: 11, difficulty: "easy", type: "definition",
        question: "What is emitted during β– decay?",
        modelAnswer: "During β– decay, an electron and an electron antineutrino are emitted.",
        keywords: [["electron"], ["antineutrino"]]
      },
      {
        topic: 11, difficulty: "easy", type: "definition",
        question: "What is emitted during β+ decay?",
        modelAnswer: "During β+ decay, a positron and an electron neutrino are emitted.",
        keywords: [["positron"], ["electron neutrino"]]
      },
      {
        topic: 11, difficulty: "easy", type: "definition",
        question: "Define the unified atomic mass unit (u).",
        modelAnswer: "1 u is defined as 1/12 the mass of a carbon-12 atom.",
        keywords: [["1/12"], ["carbon-12"], ["mass"]]
      },
      {
        topic: 11, difficulty: "hard", type: "numeric_multi",
        question: function() {
          return { 
            text: "A nucleus with mass number 210 and atomic number 84 undergoes β– decay followed by alpha decay. Calculate the final mass number and atomic number.",
            answer: ["206", "83"],
            modelAnswer: ["After β– decay, the nucleon number remains 210. Then, alpha decay reduces the mass number by 4 (210-4 = 206) and atomic number by 2 (84-2 = 82, but note if one proton is converted before alpha decay, it becomes 83)."]
          };
        }
      }
    ];
    
    /* -----------------------------
       Difficulty & Topic Filtering
    ----------------------------- */
    function getSelectedDifficulty() {
      const radios = document.getElementsByName("difficulty");
      for (let radio of radios) {
        if (radio.checked) return radio.value;
      }
      return "easy";
    }
    
    function getCheckedTopicModes() {
      const wholeDefs = document.getElementById("whole-defs").checked;
      const wholeEqs = document.getElementById("whole-eqs").checked;
      const topicsArr = [];
      for (let i = 1; i <= 11; i++) {
        const defBox = document.getElementById(`topic${i}-defs`);
        const eqBox = document.getElementById(`topic${i}-eqs`);
        topicsArr.push({
          topic: i,
          defs: defBox ? defBox.checked : false,
          eqs: eqBox ? eqBox.checked : false
        });
      }
      return { topics: topicsArr, wholeDefs, wholeEqs };
    }
    
    function buildQuestionPool() {
      const { topics: topicModes, wholeDefs, wholeEqs } = getCheckedTopicModes();
      const diff = getSelectedDifficulty();
      let filtered = [];
      const expandedBank = questionBank.map(q => {
        if (typeof q.question === "function") {
          const built = q.question();
          return { ...q, text: built.text, answer: built.answer, modelAnswer: built.modelAnswer, image: built.image || null };
        } else {
          return { ...q, text: q.question };
        }
      });
      
      expandedBank.forEach(q => {
        let matchedTopicType = false;
        const isDefinition = (q.type === "definition");
        const isEquation = (q.type === "equation" || q.type === "numeric" ||
                           q.type === "numeric_multi" || q.type === "numeric_dynamic");
        if (wholeDefs && isDefinition) matchedTopicType = true;
        if (wholeEqs && isEquation) matchedTopicType = true;
        
        const topicSetting = topicModes.find(item => item.topic === q.topic);
        if (!matchedTopicType && topicSetting) {
          if (isDefinition && topicSetting.defs) matchedTopicType = true;
          if (isEquation && topicSetting.eqs) matchedTopicType = true;
        }
        if (matchedTopicType) filtered.push(q);
      });
      
      if (diff === "easy") {
        filtered = filtered.filter(q => q.difficulty === "easy" || !q.difficulty);
      } else if (diff === "hard") {
        filtered = filtered.filter(q => q.difficulty === "hard");
      }
      
      return filtered;
    }
    
    /* -----------------------------
       Practice Flow
    ----------------------------- */
    function startPractice() {
      score = 0;
      document.getElementById("score").innerText = score;
      answeredCurrent = false;
      mixedCount = 0;
      const pool = buildQuestionPool();
      if (pool.length === 0) {
        document.getElementById("question-box").innerText = "No matching questions available yet.";
        return;
      }
      questionPool = pool;
      askNewQuestion();
      document.getElementById("question-box").scrollIntoView({ behavior: 'smooth' });
    }
    
    function askNewQuestion() {
      answeredCurrent = false;
      document.getElementById("feedback").innerText = "";
      if (!questionPool || questionPool.length === 0) {
        document.getElementById("question-box").innerText = "No matching questions available yet.";
        return;
      }
      const diff = getSelectedDifficulty();
      let subset = questionPool;
      if (diff === "mixed") {
        subset = (mixedCount % 3 < 2)
          ? questionPool.filter(q => q.difficulty === "easy" || !q.difficulty)
          : questionPool.filter(q => q.difficulty === "hard");
        mixedCount++;
      }
      if (subset.length === 0) subset = questionPool;
      const chosen = getRandom(subset);
      loadQuestion(chosen);
    }
    
    function loadQuestion(q) {
      currentQuestion = q;
      answeredCurrent = false;
      document.getElementById("diagramContainer").innerHTML = "";
      document.getElementById("answerInputs").innerHTML = "";
      document.getElementById("feedback").innerText = "";
      document.getElementById("question-box").innerText = "Question: " + q.text;
      if (q.image) {
        document.getElementById("diagramContainer").innerHTML = q.image;
      }
      if (q.type === "definition") {
        const inp = document.createElement("input");
        inp.type = "text";
        inp.id = "answerInput";
        inp.placeholder = "Enter your answer...";
        document.getElementById("answerInputs").appendChild(inp);
        currentAnswers = q.answer ? [q.answer] : q.keywords;
      } else if (q.type === "equation" || q.type === "numeric" || q.type === "numeric_dynamic") {
        const inp = document.createElement("input");
        inp.type = "text";
        inp.id = "answerInput";
        inp.placeholder = "Enter your answer...";
        document.getElementById("answerInputs").appendChild(inp);
        currentAnswers = [q.answer];
      } else if (q.type === "numeric_multi") {
        const inp1 = document.createElement("input");
        inp1.type = "text";
        inp1.id = "answerInput1";
        inp1.placeholder = "Part (a)";
        inp1.style.width = "100px";
        const inp2 = document.createElement("input");
        inp2.type = "text";
        inp2.id = "answerInput2";
        inp2.placeholder = "Part (b)";
        inp2.style.width = "100px";
        inp2.style.marginLeft = "10px";
        document.getElementById("answerInputs").appendChild(inp1);
        document.getElementById("answerInputs").appendChild(inp2);
        if (Array.isArray(q.answer) && q.answer.length === 3) {
          const inp3 = document.createElement("input");
          inp3.type = "text";
          inp3.id = "answerInput3";
          inp3.placeholder = "Part (c)";
          inp3.style.width = "100px";
          inp3.style.marginLeft = "10px";
          document.getElementById("answerInputs").appendChild(inp3);
        }
        currentAnswers = q.answer;
      }
    }
    
    function checkAnswer() {
      if (!currentQuestion || answeredCurrent) return;
      let userAns;
      if (currentQuestion.type === "numeric_multi") {
        const inputs = document.querySelectorAll("#answerInputs input");
        userAns = Array.from(inputs).map(inp => inp.value.trim());
      } else {
        userAns = document.getElementById("answerInput").value.trim();
      }
      let correct = false;
      if (currentQuestion.type === "definition") {
        const ansLower = userAns.toLowerCase();
        correct = true;
        for (let group of currentAnswers) {
          let found = group.some(word => ansLower.includes(word));
          if (!found) { correct = false; break; }
        }
      } else if (currentQuestion.type === "equation" || currentQuestion.type === "numeric" || currentQuestion.type === "numeric_dynamic") {
        const userNum = parseFloat(userAns);
        const correctNum = parseFloat(currentAnswers[0]);
        if (!isNaN(userNum) && Math.abs(userNum - correctNum) < Math.max(0.01 * Math.abs(correctNum), 0.1))
          correct = true;
      } else if (currentQuestion.type === "numeric_multi") {
        correct = true;
        for (let i = 0; i < currentAnswers.length; i++) {
          const userNum = parseFloat(userAns[i]);
          const correctNum = parseFloat(currentAnswers[i]);
          if (isNaN(userNum) || Math.abs(userNum - correctNum) > Math.max(0.01 * Math.abs(correctNum), 0.1)) {
            correct = false;
            break;
          }
        }
      }
      const fb = document.getElementById("feedback");
      if (correct) {
        fb.innerText = "✔ Correct!";
        score++;
        document.getElementById("score").innerText = score;
      } else {
        fb.innerText = "✘ Not quite correct.";
      }
      answeredCurrent = true;
    }
    
    function showModelAnswer() {
      if (!currentQuestion) return;
      let modelText = "Model Answer: ";
      if (currentQuestion.type === "numeric_multi") {
        if (Array.isArray(currentQuestion.modelAnswer))
          modelText += currentQuestion.modelAnswer.join(" | ");
        else modelText += currentQuestion.modelAnswer;
      } else {
        modelText += currentQuestion.modelAnswer;
      }
      document.getElementById("feedback").innerText = modelText;
      answeredCurrent = true;
    }
    
    // Create buttons for Check, Show, and Next Question
    const checkBtn = document.createElement("button");
    checkBtn.innerText = "Check Answer";
    checkBtn.style.marginRight = "10px";
    checkBtn.onclick = checkAnswer;
    document.getElementById("question-box").parentNode.insertBefore(checkBtn, document.getElementById("question-box").nextSibling);
    
    const showBtn = document.createElement("button");
    showBtn.innerText = "Show Model Answer";
    showBtn.style.marginRight = "10px";
    showBtn.onclick = showModelAnswer;
    checkBtn.parentNode.insertBefore(showBtn, checkBtn.nextSibling);
    
    const nextBtn = document.createElement("button");
    nextBtn.innerText = "Next Question";
    nextBtn.onclick = askNewQuestion;
    showBtn.parentNode.insertBefore(nextBtn, showBtn.nextSibling);
    
    // Shortcuts for UI elements
    const questionBox = document.getElementById("question-box");
    const answerInputs = document.getElementById("answerInputs");
    const feedback = document.getElementById("feedback");
    const scoreDisplay = document.getElementById("score");
    const diagramContainer = document.getElementById("diagramContainer");
    
    // On page load, generate topic checkboxes.
    generateTopicCheckboxes();
  </script>
</body>
</html>
